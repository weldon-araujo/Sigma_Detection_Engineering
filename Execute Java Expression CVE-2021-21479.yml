title:  inject and execute java expression compromising the availability and integrity of the system
status: experimental
author: A.W. Networksecure Segurança da Informação LTDA.
date: 2023/08/24
description: regitry in CVE-2021-21479In SCIMono before 0.0.19, it is possible for an attacker to inject and execute java expression compromising the availability and integrity of the system.
references:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21479
  - https://securitylab.github.com/advisories/GHSL-2020-227-scimono-ssti/
tags:
  - inject attack
logsource:
  product: 
    - Web Application Firewall
    - IDS
    - IPS
detection:
  selection:
    httpMethod: GET
    url: 
      - /Schemas/${''.class.forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('js').eval('java.lang.Runtime.getRuntime().exec("id")')}
      - /Schemas/$%7B''.class.forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('js').eval('java.lang.Runtime.getRuntime().exec(\"id\")')%7D
  condition: OR
fields:
  - url
  - httpMethod
level: medium